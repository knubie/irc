<template name="messages">
  <ul class="messages nav nav-stacked">
    {{#each messages}}
      {{> message}}
    {{/each}}
  </ul>
  {{#unless currentUser}}
    <div class="alert alert-info">
      <strong>
        <a href="/" class="btn">
          Sign up for free
        </a>
        to join this discussion.
      </strong>
      Already have an account?
      <a href="/login">
        Sign in to chat
      </a>
    </div>
  {{/unless}}
</template>

<template name="message">
  {{#if joinToPrev}}
    <li id="{{_id}}" data-nick="{{from}}" data-channel="{{channel}}" class="message join {{message_class}}">
      <div class="divider"></div>
      <small class="muted pull-right">{{timeAgo}}</small>
      <p>{{text}}</p>
    </li>
  {{else}}
    <li id="{{_id}}" data-nick="{{from}}" data-channel="{{channel}}" class="message {{message_class}}">
      <span class="reply">
        <span class="{{status}}">&bull;</span>
        <strong>{{from}}</strong>
        {{#if all}}
          <span class="muted">{{channel}}</span>
        {{/if}}
      </span>
      {{#unless self}}
        {{#if currentUser}}
          &nbsp;
          <div class="actions">
            <div class="action reply-action">
              <i class="icon-share-alt"></i> Reply
            </div>
            &nbsp;
            <div class="action ignore-action">
              <i class="icon-volume-off"></i> Ignore
            </div>
            {{#if op_status}}
              &nbsp;
              <div class="action kick">
                <i class="icon-share"></i> Kick
              </div>
              &nbsp;
              <div class="action">
                <i class="icon-ban-circle"></i> Ban
              </div>
            {{/if}}
            {{#if isConvo}}
              &nbsp;
              <div class="action convo">
                <i class="icon-comment"></i> View conversation
              </div>
            {{/if}}
          </div>
        {{/if}}
      {{/unless}}
      <small class="muted pull-right">{{timeAgo}}</small>
      <p>{{text}}</p>
    </li>
  {{/if}}
</template>

