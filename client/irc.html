<head>
  <title>Twirc</title>
</head>

<body>
  <div style="position: absolute; top:5px; right:5px;">
    {{loginButtons align='right'}}
  </div>
  {{> home}}
  {{#if currentUser}}
    {{> dashboard}}
  {{/if}}
</body>

<template name="home">
  {{#unless currentUser}}
    <h1 class="headline">twirc</h1>
    <form id="auth-form">
      <input type="text" id="auth-nick" placeholder="Nick">
      <input type="password" id="auth-pw" placeholder="Password">
      <input type="submit" value="Go">
    </form>
  {{/unless}}
</template>

<template name="dashboard">
  {{#if connecting}}
    Connecting..
  {{else}}
    <ul class="channels nav nav-stacked">
      <li class="logo">Twirc</li>
      <li class="nav-item"><a href="#">Explore</a></li>
      <li class="nav-item"><a href="#">Account</a></li>
      <li class="nav-item"><a href="#">Sign Out</a></li>
      {{> channels}}
    </ul>
    <div class="messages-container">
      {{> messages}}
    </div>
  {{/if}}
</template>

<template name="channels">
  <li class="new-channel-li">
    <form id="new-channel">
      <input type="text" id="new-channel-name" autocomplete="off" placeholder="Add Channel">
    </form>
  </li>
  {{#each channels}}
    <li class="channel {{selected}}">
      <a href="#">
        {{name}}
        <button type="button" class="close">&times;</button>
        <span class="badge badge-info">{{notification_count}}</span>
      </a>
    </li>
  {{/each}}
</template>

<template name="channel">
</template>

<template name="messages">
  <ul class="messages nav nav-stacked">
    {{#each messages}}
      {{> message}}
    {{/each}}
  </ul>
  <ul class="notifications nav nav-stacked">
    {{#each notifications}}
      {{> notification}}
    {{/each}}
  </ul>
  <div class="input-container">
    <form id="say">
      <input type="text" class="span6" id="say-input" autocomplete="off" placeholder="Send a message or type ? for help.">
    </form>
  </div>
</template>

<template name="message">
  {{#if joinToPrev}}
    <li id="{{_id}}" data-nick="{{from}}" data-channel="{{to}}" class="message join {{message_class}}">
      <div class="divider"></div>
      <small class="muted pull-right">{{timeAgo}}</small>
      <p>{{text}}</p>
    </li>
  {{else}}
    <li id="{{_id}}" data-nick="{{from}}" data-channel="{{to}}" {{convo}} class="message {{message_class}}">
      <span class="reply">
        <strong>{{from}}</strong>
        {{#if all}}
          <span class="muted">{{channel}}</span>
        {{/if}}
      </span>
      &nbsp;
      <div class="actions">
        <div class="action">
          <i class="icon-share-alt"></i> Reply
        </div>
        &nbsp;
        <div class="action">
          <i class="icon-volume-off"></i> Ignore
        </div>
        {{#if op_status}}
          &nbsp;
          <div class="action">
            <i class="icon-share"></i> Kick
          </div>
          &nbsp;
          <div class="action">
            <i class="icon-ban-circle"></i> Ban
          </div>
        {{/if}}
        {{#if isConvo}}
          &nbsp;
          <div class="action convo">
            <i class="icon-comment"></i> View conversation
          </div>
        {{/if}}
      </div>
      <small class="muted pull-right">{{timeAgo}}</small>
      <p>{{text}}</p>
    </li>
  {{/if}}
</template>

<template name="notification">
  <li id="{{_id}}" data-channel="{{to}}" class="message">
    <span class="reply">
      <strong>{{from}}</strong>
      <button type="button" class="close">&times;</button>
      {{#if all}}
        <span class="muted">{{to}}</span>
      {{/if}}
    </span>
    <small class="muted pull-right">{{timeAgo}}</small>
    <p>{{text}}</p>
  </li>
</template>

<template  name="explore">
  <ul class="nav nav-pills">
  <li class="active">
    <a href="#">##meteor_test</a>
  </li>
  <li><a href="#">#other_channel</a></li>
  <li><a href="#">#sausage</a></li>
</ul>
</template>
